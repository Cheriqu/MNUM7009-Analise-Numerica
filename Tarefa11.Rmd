---
lang: "pt-br"
output:
  pdf_document:
    extra_dependencies: float
    latex_engine: xelatex
  word_document: default
header-includes:
- \usepackage{cancel}
- \usepackage{fancyhdr}
- \usepackage{pdfpages}
- \pagestyle{fancy}
- \fancyhf{}
- \renewcommand{\headrulewidth}{0pt}
- \fancyfoot[L]{\includegraphics[width=2cm]{logo.png}}
- \fancyfoot[C]{}
- \fancyfoot[R]{Página \thepage}
editor_options:
  markdown:
    wrap: 72
---

# Tarefa 11

17. Considere a integral:

$$ I = \int_{0}^{1} e^{-x^2} dx $$

a) Estime I pela regra de Simpson e do Trapézio usando h = 0.25.

b) Estime I por Quadratura Gaussiana com 2 pontos.

c) Sabendo que o valor exato de I (usando 5 casas decimais) é $0.74682$, pede-se:

* c1) compare as estimativas obtidas em (a) e (b);

* c2) quantos pontos seriam necessários para que a regra dos Trapézios obtivesse a mesma precisão que a estimativa obtida para I em (b)?

```{r}
# Definição
f <- function(x) { exp(-x^2) }
I_real <- 0.74682
h <- 0.25
a <- 0
b <- 1

# Regra dos Trapézios e Simpson com h=0.25
m <- (b - a) / h
x <- seq(a, b, by = h)
y <- f(x)

# Regra dos Trapézios
I_tr <- (h/2) * (y[1] + 2*sum(y[2:m]) + y[m+1])

# Regra 1/3 de Simpson
# como  m=4, número par de intervalos, regra se aplica diretamente
I_sr <- (h/3) * (y[1] + 
                 4*sum(y[seq(2, m, by=2)]) + 
                 2*sum(y[seq(3, m-1, by=2)]) + 
                 y[m+1])

# Quadratura Gaussiana com 2 pontos
# g(t) é a função f(x) mapeada para o intervalo [-1, 1]
# x = (b-a)/2 * t + (b+a)/2 = 0.5*t + 0.5
# dx = (b-a)/2 * dt = 0.5 * dt
g <- function(t) { 0.5 * f(0.5 * t + 0.5) }

# Nós e pesos da Quadratura de Gauss-Legendre de 2 pontos
t_gauss <- c(-sqrt(1/3), sqrt(1/3))
w_gauss <- c(1, 1)
I_g <- sum(w_gauss * g(t_gauss))

# Comparação dos Erros
E_tr <- abs(I_real - I_tr)
E_sr <- abs(I_real - I_sr)
E_g <- abs(I_real - I_g)

# Resultados
resultados_df <- data.frame(
  Metodo = c("Trapézios (h=0.25)", "Simpson (h=0.25)", "Gaussiana (2 pontos)"),
  Estimativa = c(I_tr, I_sr, I_g),
  Valor_Real = I_real,
  Erro_Absoluto = c(E_tr, E_sr, E_g))

knitr::kable(resultados_df, digits = 9, caption = "Comparação dos Métodos de Integração")
```


Para que a Regra dos Trapézios obtenha uma precisão igual ou superior (erro menor ou igual), são necessários:

```{r}
# Pontos necessários para a Regra dos Trapézios
# Precisamos do máximo da segunda derivada de f(x) em [0, 1]
f2 <- function(x) { (4*x^2 - 2) * exp(-x^2) }
# O máximo de |f''(x)| em [0, 1] ocorre em x=0
M2 <- abs(f2(0)) # M2 = 2

# Usamos a fórmula do erro |E_TR| <= M2 * (b-a) * h^2 / 12
# |E_TR| = M2 / (12 * m^2)
# Queremos |E_TR| <= E_g  =>  M2 / (12 * m^2) <= E_g
# m^2 >= M2 / (12 * E_g)
m_req <- sqrt(M2 / (12 * E_g))
m_final <- ceiling(m_req)
pontos_necessarios <- m_final + 1

cat(sprintf("Foram necessários m = %d subintervalos.", m_final))
cat(sprintf("Isso corresponde a %d pontos de avaliação (nós).", pontos_necessarios))
```